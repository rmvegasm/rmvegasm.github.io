{"title":"Extracting tweets with the twitter API","markdown":{"yaml":{"title":"Extracting tweets with the twitter API","categories":["R","NLP","rtweet","TPP11"],"date":"2022/09/12"},"headingText":"Authenticate the currently logged in user and store credentials, this needs to","containsRefs":false,"markdown":"\n\nToday the TPP11 was approved by the chilean congress. WTF!?\n\nLet's try to get an idea of what people are saying about this on twitter.\n\n```{r}\nlibrary('rtweet')\n# be done only once per machine:\n# rtweet::auth_setup_default()\n\n# Do not perform query if results are already stored:\ntbl_file = 'tweets_tbl'\ntweets_file = 'tpp11_tweets.csv'\n\nif (file.exists(tweets_file)) {\n  tweets = read.csv(tweets_file)\n} else {\n  tweets = rtweet::search_tweets(\n    'TPP11 Chile -filter:quote -filter:replies',\n    n = 1000,\n    include_rts = FALSE,\n    retryonratelimit = TRUE\n  )\n  # let's save the tibble just in case and write a csv ommiting list cols\n  saveRDS(tweets, tbl_file)\n  tweets = tweets[, sapply(tweets, class) != 'list'] |> as.data.frame()\n  write.csv(tweets, tweets_file)\n}\n```\n\nLet's take a look at what we got:\n\n```{r, purl = FALSE}\nstr(tweets, give.attr = FALSE)\n```\n\nThe most *retweeted* text (presumably the original) is:\n\n```{r, purl = FALSE}\nwith(tweets, full_text[which.max(retweet_count)]) |>\n  strwrap() |>\n  cat(fill = TRUE)\n```\n\n```{r, include = FALSE, purl = FALSE}\nknitr::purl('index.qmd', output = 'script.r')\n```\n\n```{r filename = 'Complete Code', file = 'script.r', eval = FALSE, purl = FALSE}\n\n```\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"output-file":"index.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.1.189","theme":"cosmo","title-block-banner":true,"title":"Extracting tweets with the twitter API","categories":["R","NLP","rtweet","TPP11"],"date":"2022/09/12"},"extensions":{"book":{"multiFile":true}}}}}